<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.gss.web.common.mapper.MemberMapper">
	<insert id="joinUp" parameterType="com.gss.web.common.domain.Member">
		INSERT INTO gssusertab (
			gssuserid,
			email, 
			userpassword, 
			userphone,
			privilge,
			username
		) values(
			#{gssuserId},
			#{email},
			#{userPassword},
			#{userPhone},
			#{privilge},
			#{userName}
		)
	</insert>
	
	<update id="editUserInfo" parameterType="com.gss.web.common.domain.Member">
		update gssusertab 
		set email=#{email},
			userpassword=#{userPassword},
			userphone=#{userPhone},
			username=#{userName}
		where gssuserid=#{gssuserId}	
	</update>
	<select id="findByMyInfoList" parameterType="int" resultType="com.gss.web.common.domain.MyInfoList">
		select p.partyname ,m.charatername  
		from memberofpartytab m join partytab p on m.partynum  =p.partynum  
		where m.gssusernum =#{gssuserid} and partyleader=true
	</select>
	
	<select id="findByMyInfoListMember" parameterType="int" resultType="com.gss.web.common.domain.MyInfoList">
		select p.partyname ,m.charatername  
		from memberofpartytab m join partytab p on m.partynum  =p.partynum  
		where m.gssusernum =#{gssuserid} and partyleader=false
	</select>
	
	<select id="checkEmail" parameterType="String" resultType="boolean">
		select count(*)
		from gssusertab 
		where email=#{email}
	</select>
	
	<select id="checkID" parameterType="String" resultType="boolean">
		select count(*)
		from gssusertab 
		where gssuserid=#{userID}
	</select>
	
	<select id="checkPhoneNum" parameterType="String" resultType="boolean">
		select count(*)
		from gssusertab 
		where userphone=#{phoneNumber}
	</select>
	
	<select id="findByUserPK" parameterType="int" resultType="com.gss.web.common.domain.Member">
		select
			gssusernum,
			gssuserid,
			email, 
			userpassword, 
			userphone,
			privilge,
			username
		from gssusertab
		where gssusernum = #{userKey} 
	</select>
	
	<select id="findByEmail" parameterType="String" resultType="com.gss.web.common.domain.Member">
		select
			gssusernum,
			gssuserid,
			email, 
			userpassword, 
			userphone,
			privilge,
			username
		from gssusertab
		where email = #{email} 
	</select>
	
	<select id="findByID" parameterType="String" resultType="com.gss.web.common.domain.Member">
		select
			gssusernum,
			gssuserid,
			email, 
			userpassword, 
			userphone,
			privilge,
			username
		from gssusertab
		where gssuserid= #{userId} 
	</select>
	<select id="checkPartyNick" parameterType="com.gss.web.common.domain.MyInfoList" resultType="int">
		SELECT count(m.charatername) 
		from memberofpartytab m join partytab p
		on m.partynum =p.partynum 
		where  m.charatername=#{charaterName}
	</select>
	<update id="updatePartyNick" parameterType="com.gss.web.common.domain.MyInfoList">
	update  memberofpartytab m 
	set charatername  =#{charaterName}
	from partytab p
	where p.partynum =m.partynum and p.partyname=#{partyName} and m.gssusernum=#{gssUserNum}
	</update>
</mapper>