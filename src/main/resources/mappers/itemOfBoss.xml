<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.gss.web.common.mapper.ItemOfBossMapper">
	<insert id="insertItemOfBoss" parameterType="com.gss.web.common.domain.ItemOfBoss">
	INSERT INTO itemofbosstab (
		itemnum,
		bossnum
	) VALUES (
		(select 
			itemnum 
		from 
			itemtab 
		where 
			itemnum = #{itemNum}),
		(select 
			bossnum 
		from 
			bosstab 
		where 
			bossname= #{bossName} and bossgrade= #{bossGrade})
	)
	</insert>
	
	<select id="selectAllItemOfBoss" parameterType="Map" resultType="int">
		select
			itemnum
		from 
			itemofbosstab
		where 
			bossnum = (
				select 
					bossnum 
				from 
					bosstab 
				where 
					bossname = #{bossName} and bossgrade= #{bossGrade})
	</select>
	
	<select id="selectByBossItem" parameterType="int" resultType="com.gss.web.common.domain.Item">
		select 
			itemnum,
			itemname, 
			itemimagepath, 
			classification 
		from 
			itemtab 
		where 
			itemnum = #{itemNum}
	</select>
	
	<select id="selectByBoss" parameterType="int" resultType="com.gss.web.common.domain.Boss">
		select 
			bossname,
			bossgrade 
		from 
			bosstab 
		where 
			bossnum = #{bossNum}
	</select>
	
	<select id="selectInsertItemList" parameterType="Map" resultType="int">
		select 
			it.itemnum 
		from 
			itemtab as it 
			join itemofbosstab as io
		on 
			it.itemnum = io.itemnum 
			and io.bossnum = 
			(select 
				bossnum 
			from 
				bosstab 
			where 
				bossname = #{bossName} and bossgrade=#{bossGrade});
	</select>
	
	<select id="selectItemListByItemNum" parameterType="int" resultType="com.gss.web.common.domain.Item">
		select 
			itemname, 
			itemimagepath, 
			classification  
		from 
			itemtab 
		where not 
			itemnum = #{itemNum};
	</select>
	
	<delete id="deleteItemListByItemNum" parameterType="com.gss.web.common.domain.ItemOfBoss">
		delete
		from
			itemofbosstab
		where
			bossnum= (
				select 
					bossnum 
				from 
					bosstab 
				where 
					bossname = #{bossName} and bossgrade = #{bossGrade}) 
				and 
					itemnum = #{itemNum}
	</delete>
</mapper>